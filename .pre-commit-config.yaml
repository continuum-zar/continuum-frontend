# Pre-commit hooks configuration
# Run `pre-commit install` to set up the git hooks
# Run `pre-commit run --all-files` to run all hooks manually

repos:
  # Standard pre-commit hooks
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.6.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: check-yaml
      - id: check-json
      - id: check-added-large-files
        args: ['--maxkb=1000']
      - id: check-merge-conflict
      - id: detect-private-key

  # Local hooks for project-specific checks
  - repo: local
    hooks:
      # Frontend TypeScript Type Check
      - id: frontend-typecheck
        name: Frontend Type Check (TypeScript)
        entry: bash -c 'cd continuum-frontend && npm run typecheck'
        language: system
        files: ^continuum-frontend/src/.*\.(ts|tsx)$
        pass_filenames: false

      # Frontend ESLint
      - id: frontend-lint
        name: Frontend Lint (ESLint)
        entry: bash -c 'if command -v npm > /dev/null 2>&1 && [ -f continuum-frontend/package.json ]; then cd continuum-frontend && npm run lint || echo "ESLint check skipped (dependencies not installed)"; else echo "ESLint check skipped (npm not available)"; fi'
        language: system
        files: ^continuum-frontend/src/.*\.(ts|tsx)$
        pass_filenames: false

      # Frontend Build Check (ensures the project builds)
      - id: frontend-build
        name: Frontend Build Check
        entry: bash -c 'cd continuum-frontend && npm run build'
        language: system
        files: ^continuum-frontend/src/.*\.(ts|tsx)$
        pass_filenames: false
        stages: [pre-push]  # Only run on push, not commit (takes longer)
